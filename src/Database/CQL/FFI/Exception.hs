{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE OverloadedStrings #-}

module Database.CQL.FFI.Exception where

import Control.Exception

data CassError = CASS_OK
               | LIB_BAD_PARAMS
               | LIB_NO_STREAMS
               | LIB_UNABLE_TO_INIT
               | LIB_MESSAGE_ENCODE
               | LIB_HOST_RESOLUTION
               | LIB_UNEXPECTED_RESPONSE
               | LIB_REQUEST_QUEUE_FULL
               | LIB_NO_AVAILABLE_IO_THREAD
               | LIB_WRITE_ERROR
               | LIB_NO_HOSTS_AVAILABLE
               | LIB_INDEX_OUT_OF_BOUNDS
               | LIB_INVALID_ITEM_COUNT
               | LIB_INVALID_VALUE_TYPE
               | LIB_REQUEST_TIMED_OUT
               | LIB_UNABLE_TO_SET_KEYSPACE
               | LIB_CALLBACK_ALREADY_SET
               | LIB_INVALID_STATEMENT_TYPE
               | LIB_NAME_DOES_NOT_EXIST
               | LIB_UNABLE_TO_DETERMINE_PROTOCOL
               | LIB_NULL_VALUE
               | LIB_NOT_IMPLEMENTED
               | LIB_UNABLE_TO_CONNECT
               | LIB_UNABLE_TO_CLOSE
               | LIB_NO_PAGING_STATE
               | LIB_PARAMETER_UNSET
               | LIB_INVALID_ERROR_RESULT_TYPE
               | LIB_INVALID_FUTURE_TYPE
               | LIB_INTERNAL_ERROR
               | LIB_INVALID_CUSTOM_TYPE
               | LIB_INVALID_DATA
               | LIB_NOT_ENOUGH_DATA
               | LIB_INVALID_STATE
               | LIB_NO_CUSTOM_PAYLOAD
               | LIB_EXECUTION_PROFILE_INVALID
               | LIB_NO_TRACING_ID
               | SERVER_SERVER_ERROR
               | SERVER_PROTOCOL_ERROR
               | SERVER_BAD_CREDENTIALS
               | SERVER_UNAVAILABLE
               | SERVER_OVERLOADED
               | SERVER_IS_BOOTSTRAPPING
               | SERVER_TRUNCATE_ERROR
               | SERVER_WRITE_TIMEOUT
               | SERVER_READ_TIMEOUT
               | SERVER_READ_FAILURE
               | SERVER_FUNCTION_FAILURE
               | SERVER_WRITE_FAILURE
               | SERVER_SYNTAX_ERROR
               | SERVER_UNAUTHORIZED
               | SERVER_INVALID_QUERY
               | SERVER_CONFIG_ERROR
               | SERVER_ALREADY_EXISTS
               | SERVER_UNPREPARED
               | SSL_INVALID_CERT
               | SSL_INVALID_PRIVATE_KEY
               | SSL_NO_PEER_CERT
               | SSL_INVALID_PEER_CERT
               | SSL_IDENTITY_MISMATCH
               | SSL_PROTOCOL_ERROR
               | SSL_CLOSED
    deriving (Eq, Show)

{-
instance Show CassError where
    show CASS_OK = "OK"
    show LIB_BAD_PARAMS = "LIB"
    show LIB_NO_STREAMS = 16777218
    show LIB_UNABLE_TO_INIT = 16777219
    show LIB_MESSAGE_ENCODE = 16777220
    show LIB_HOST_RESOLUTION = 16777221
    show LIB_UNEXPECTED_RESPONSE = 16777222
    show LIB_REQUEST_QUEUE_FULL = 16777223
    show LIB_NO_AVAILABLE_IO_THREAD = 16777224
    show LIB_WRITE_ERROR = 16777225
    show LIB_NO_HOSTS_AVAILABLE = 16777226
    show LIB_INDEX_OUT_OF_BOUNDS = 16777227
    show LIB_INVALID_ITEM_COUNT = 16777228
    show LIB_INVALID_VALUE_TYPE = 16777229
    show LIB_REQUEST_TIMED_OUT = 16777230
    show LIB_UNABLE_TO_SET_KEYSPACE = 16777231
    show LIB_CALLBACK_ALREADY_SET = 16777232
    show LIB_INVALID_STATEMENT_TYPE = 16777233
    show LIB_NAME_DOES_NOT_EXIST = 16777234
    show LIB_UNABLE_TO_DETERMINE_PROTOCOL = 16777235
    show LIB_NULL_VALUE = 16777236
    show LIB_NOT_IMPLEMENTED = 16777237
    show LIB_UNABLE_TO_CONNECT = 16777238
    show LIB_UNABLE_TO_CLOSE = 16777239
    show LIB_NO_PAGING_STATE = 16777240
    show LIB_PARAMETER_UNSET = 16777241
    show LIB_INVALID_ERROR_RESULT_TYPE = 16777242
    show LIB_INVALID_FUTURE_TYPE = 16777243
    show LIB_INTERNAL_ERROR = 16777244
    show LIB_INVALID_CUSTOM_TYPE = 16777245
    show LIB_INVALID_DATA = 16777246
    show LIB_NOT_ENOUGH_DATA = 16777247
    show LIB_INVALID_STATE = 16777248
    show LIB_NO_CUSTOM_PAYLOAD = 16777249
    show LIB_EXECUTION_PROFILE_INVALID = 16777250
    show LIB_NO_TRACING_ID = 16777251
    show SERVER_SERVER_ERROR = 33554432
    show SERVER_PROTOCOL_ERROR = 33554442
    show SERVER_BAD_CREDENTIALS = 33554688
    show SERVER_UNAVAILABLE = 33558528
    show SERVER_OVERLOADED = 33558529
    show SERVER_IS_BOOTSTRAPPING = 33558530
    show SERVER_TRUNCATE_ERROR = 33558531
    show SERVER_WRITE_TIMEOUT = 33558784
    show SERVER_READ_TIMEOUT = 33559040
    show SERVER_READ_FAILURE = 33559296
    show SERVER_FUNCTION_FAILURE = 33559552
    show SERVER_WRITE_FAILURE = 33559808
    show SERVER_SYNTAX_ERROR = 33562624
    show SERVER_UNAUTHORIZED = 33562880
    show SERVER_INVALID_QUERY = 33563136
    show SERVER_CONFIG_ERROR = 33563392
    show SERVER_ALREADY_EXISTS = 33563648
    show SERVER_UNPREPARED = 33563904
    show SSL_INVALID_CERT = 50331649
    show SSL_INVALID_PRIVATE_KEY = 50331650
    show SSL_NO_PEER_CERT = 50331651
    show SSL_INVALID_PEER_CERT = 50331652
    show SSL_IDENTITY_MISMATCH = 50331653
    show SSL_PROTOCOL_ERROR = 50331654
    show SSL_CLOSED = 503316505
-}

instance Enum CassError where
    fromEnum CASS_OK = 0
    fromEnum LIB_BAD_PARAMS = 16777217
    fromEnum LIB_NO_STREAMS = 16777218
    fromEnum LIB_UNABLE_TO_INIT = 16777219
    fromEnum LIB_MESSAGE_ENCODE = 16777220
    fromEnum LIB_HOST_RESOLUTION = 16777221
    fromEnum LIB_UNEXPECTED_RESPONSE = 16777222
    fromEnum LIB_REQUEST_QUEUE_FULL = 16777223
    fromEnum LIB_NO_AVAILABLE_IO_THREAD = 16777224
    fromEnum LIB_WRITE_ERROR = 16777225
    fromEnum LIB_NO_HOSTS_AVAILABLE = 16777226
    fromEnum LIB_INDEX_OUT_OF_BOUNDS = 16777227
    fromEnum LIB_INVALID_ITEM_COUNT = 16777228
    fromEnum LIB_INVALID_VALUE_TYPE = 16777229
    fromEnum LIB_REQUEST_TIMED_OUT = 16777230
    fromEnum LIB_UNABLE_TO_SET_KEYSPACE = 16777231
    fromEnum LIB_CALLBACK_ALREADY_SET = 16777232
    fromEnum LIB_INVALID_STATEMENT_TYPE = 16777233
    fromEnum LIB_NAME_DOES_NOT_EXIST = 16777234
    fromEnum LIB_UNABLE_TO_DETERMINE_PROTOCOL = 16777235
    fromEnum LIB_NULL_VALUE = 16777236
    fromEnum LIB_NOT_IMPLEMENTED = 16777237
    fromEnum LIB_UNABLE_TO_CONNECT = 16777238
    fromEnum LIB_UNABLE_TO_CLOSE = 16777239
    fromEnum LIB_NO_PAGING_STATE = 16777240
    fromEnum LIB_PARAMETER_UNSET = 16777241
    fromEnum LIB_INVALID_ERROR_RESULT_TYPE = 16777242
    fromEnum LIB_INVALID_FUTURE_TYPE = 16777243
    fromEnum LIB_INTERNAL_ERROR = 16777244
    fromEnum LIB_INVALID_CUSTOM_TYPE = 16777245
    fromEnum LIB_INVALID_DATA = 16777246
    fromEnum LIB_NOT_ENOUGH_DATA = 16777247
    fromEnum LIB_INVALID_STATE = 16777248
    fromEnum LIB_NO_CUSTOM_PAYLOAD = 16777249
    fromEnum LIB_EXECUTION_PROFILE_INVALID = 16777250
    fromEnum LIB_NO_TRACING_ID = 16777251
    fromEnum SERVER_SERVER_ERROR = 33554432
    fromEnum SERVER_PROTOCOL_ERROR = 33554442
    fromEnum SERVER_BAD_CREDENTIALS = 33554688
    fromEnum SERVER_UNAVAILABLE = 33558528
    fromEnum SERVER_OVERLOADED = 33558529
    fromEnum SERVER_IS_BOOTSTRAPPING = 33558530
    fromEnum SERVER_TRUNCATE_ERROR = 33558531
    fromEnum SERVER_WRITE_TIMEOUT = 33558784
    fromEnum SERVER_READ_TIMEOUT = 33559040
    fromEnum SERVER_READ_FAILURE = 33559296
    fromEnum SERVER_FUNCTION_FAILURE = 33559552
    fromEnum SERVER_WRITE_FAILURE = 33559808
    fromEnum SERVER_SYNTAX_ERROR = 33562624
    fromEnum SERVER_UNAUTHORIZED = 33562880
    fromEnum SERVER_INVALID_QUERY = 33563136
    fromEnum SERVER_CONFIG_ERROR = 33563392
    fromEnum SERVER_ALREADY_EXISTS = 33563648
    fromEnum SERVER_UNPREPARED = 33563904
    fromEnum SSL_INVALID_CERT = 50331649
    fromEnum SSL_INVALID_PRIVATE_KEY = 50331650
    fromEnum SSL_NO_PEER_CERT = 50331651
    fromEnum SSL_INVALID_PEER_CERT = 50331652
    fromEnum SSL_IDENTITY_MISMATCH = 50331653
    fromEnum SSL_PROTOCOL_ERROR = 50331654
    fromEnum SSL_CLOSED = 503316505

    toEnum 0 = CASS_OK
    toEnum 16777217 = LIB_BAD_PARAMS
    toEnum 16777218 = LIB_NO_STREAMS
    toEnum 16777219 = LIB_UNABLE_TO_INIT
    toEnum 16777220 = LIB_MESSAGE_ENCODE
    toEnum 16777221 = LIB_HOST_RESOLUTION
    toEnum 16777222 = LIB_UNEXPECTED_RESPONSE
    toEnum 16777223 = LIB_REQUEST_QUEUE_FULL
    toEnum 16777224 = LIB_NO_AVAILABLE_IO_THREAD
    toEnum 16777225 = LIB_WRITE_ERROR
    toEnum 16777226 = LIB_NO_HOSTS_AVAILABLE
    toEnum 16777227 = LIB_INDEX_OUT_OF_BOUNDS
    toEnum 16777228 = LIB_INVALID_ITEM_COUNT
    toEnum 16777229 = LIB_INVALID_VALUE_TYPE
    toEnum 16777230 = LIB_REQUEST_TIMED_OUT
    toEnum 16777231 = LIB_UNABLE_TO_SET_KEYSPACE
    toEnum 16777232 = LIB_CALLBACK_ALREADY_SET
    toEnum 16777233 = LIB_INVALID_STATEMENT_TYPE
    toEnum 16777234 = LIB_NAME_DOES_NOT_EXIST
    toEnum 16777235 = LIB_UNABLE_TO_DETERMINE_PROTOCOL
    toEnum 16777236 = LIB_NULL_VALUE
    toEnum 16777237 = LIB_NOT_IMPLEMENTED
    toEnum 16777238 = LIB_UNABLE_TO_CONNECT
    toEnum 16777239 = LIB_UNABLE_TO_CLOSE
    toEnum 16777240 = LIB_NO_PAGING_STATE
    toEnum 16777241 = LIB_PARAMETER_UNSET
    toEnum 16777242 = LIB_INVALID_ERROR_RESULT_TYPE
    toEnum 16777243 = LIB_INVALID_FUTURE_TYPE
    toEnum 16777244 = LIB_INTERNAL_ERROR
    toEnum 16777245 = LIB_INVALID_CUSTOM_TYPE
    toEnum 16777246 = LIB_INVALID_DATA
    toEnum 16777247 = LIB_NOT_ENOUGH_DATA
    toEnum 16777248 = LIB_INVALID_STATE
    toEnum 16777249 = LIB_NO_CUSTOM_PAYLOAD
    toEnum 16777250 = LIB_EXECUTION_PROFILE_INVALID
    toEnum 16777251 = LIB_NO_TRACING_ID
    toEnum 33554432 = SERVER_SERVER_ERROR
    toEnum 33554442 = SERVER_PROTOCOL_ERROR
    toEnum 33554688 = SERVER_BAD_CREDENTIALS
    toEnum 33558528 = SERVER_UNAVAILABLE
    toEnum 33558529 = SERVER_OVERLOADED
    toEnum 33558530 = SERVER_IS_BOOTSTRAPPING
    toEnum 33558531 = SERVER_TRUNCATE_ERROR
    toEnum 33558784 = SERVER_WRITE_TIMEOUT
    toEnum 33559040 = SERVER_READ_TIMEOUT
    toEnum 33559296 = SERVER_READ_FAILURE
    toEnum 33559552 = SERVER_FUNCTION_FAILURE
    toEnum 33559808 = SERVER_WRITE_FAILURE
    toEnum 33562624 = SERVER_SYNTAX_ERROR
    toEnum 33562880 = SERVER_UNAUTHORIZED
    toEnum 33563136 = SERVER_INVALID_QUERY
    toEnum 33563392 = SERVER_CONFIG_ERROR
    toEnum 33563648 = SERVER_ALREADY_EXISTS
    toEnum 33563904 = SERVER_UNPREPARED
    toEnum 50331649 = SSL_INVALID_CERT
    toEnum 50331650 = SSL_INVALID_PRIVATE_KEY
    toEnum 50331651 = SSL_NO_PEER_CERT
    toEnum 50331652 = SSL_INVALID_PEER_CERT
    toEnum 50331653 = SSL_IDENTITY_MISMATCH
    toEnum 50331654 = SSL_PROTOCOL_ERROR
    toEnum 50331655 = SSL_CLOSED 
    toEnum unmatched = error ("CassError.toEnum = Cannot match " ++ show unmatched)

instance Exception CassError